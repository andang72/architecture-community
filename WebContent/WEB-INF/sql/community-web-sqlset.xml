<?xml version="1.0" encoding="UTF-8"?>
<sqlset>
	<name>COMMUNITY_WEB</name>
	<description>VIEWCOUNT, IMAGE, ATTACHMENT 쿼리</description>
	<!-- ==================== -->
	<!--  VIEW  COUNT -->
	<!-- ==================== -->
	<sql-query name="VIEW_COUNT_BY_ENTITY_TYPE_AND_ENTITY_ID" description="VIEW_COUNT_BY_ENTITY_TYPE_AND_ENTITY_ID"><![CDATA[
	SELECT 
		VIEWCOUNT FROM MUSI_VIEWCOUNT 
	WHERE ENTITY_TYPE = ? AND ENTITY_ID = ? 
	]]></sql-query>		
	
	<sql-query name="DELETE_VIEW_COUNT" description="DELETE_VIEW_COUNT"><![CDATA[
	DELETE FROM MUSI_VIEWCOUNT 
	WHERE ENTITY_TYPE = ? AND ENTITY_ID = ? 
	]]></sql-query>	
	
	<sql-query name="UPDATE_VIEW_COUNT" description="UPDATE_VIEW_COUNT"><![CDATA[
	UPDATE  
		MUSI_VIEWCOUNT SET VIEWCOUNT = ?
	WHERE ENTITY_TYPE = ? AND ENTITY_ID = ? 
	]]></sql-query>	
	
	<sql-query name="CREATE_VIEW_COUNT"  description="CREATE_VIEW_COUNT"><![CDATA[
	INSERT INTO MUSI_VIEWCOUNT ( ENTITY_TYPE, ENTITY_ID, VIEWCOUNT )  VALUES (?, ?, ?)
	]]></sql-query>	
	
	<!-- ==================== -->
	<!--  COMMENT -->
	<!-- ==================== -->
	<sql-query name="SELECT_COMMENT_BY_ID" description="SELECT_COMMENT_BY_ID"><![CDATA[
	SELECT
		COMMENT_ID,
		OBJECT_TYPE,
		OBJECT_ID,
		PARENT_COMMENT_ID,
		PARENT_OBJECT_TYPE,
		PARENT_OBJECT_ID,
		USER_ID,
		NAME,
		EMAIL,
		URL,
		IP,
		BODY,
		STATUS,
		CREATION_DATE,
		MODIFIED_DATE
	FROM MUSI_COMMENT
	WHERE 
		COMMENT_ID = ?
	]]></sql-query>	
	
	<sql-query name="SELECT_COMMENTS_BY_USER" description="SELECT_COMMENTS_BY_USER"><![CDATA[
	SELECT
		COMMENT_ID,
		OBJECT_TYPE,
		OBJECT_ID,
		PARENT_COMMENT_ID,
		PARENT_OBJECT_TYPE,
		PARENT_OBJECT_ID,
		USER_ID,
		NAME,
		EMAIL,
		URL,
		IP,
		BODY,
		STATUS,
		CREATION_DATE,
		MODIFIED_DATE
	FROM MUSI_COMMENT
	WHERE 
		USER_ID = ?
	]]></sql-query>		

	<sql-query name="SELECT_COMMENTS_BY_UPDATED" description="SELECT_COMMENTS_BY_UPDATED"><![CDATA[
	SELECT
		COMMENT_ID,
		OBJECT_TYPE,
		OBJECT_ID,
		PARENT_COMMENT_ID,
		PARENT_OBJECT_TYPE,
		PARENT_OBJECT_ID,
		USER_ID,
		NAME,
		EMAIL,
		URL,
		IP,
		BODY,
		STATUS,
		CREATION_DATE,
		MODIFIED_DATE
	FROM MUSI_COMMENT
	WHERE 
		MODIFIED_DATE >= ?
	]]></sql-query>	
		
	<sql-query name="CREATE_COMMENT" description="CREATE_COMMENT"><![CDATA[
	INSERT INTO MUSI_COMMENT (
		COMMENT_ID,
		OBJECT_TYPE,
		OBJECT_ID,
		PARENT_COMMENT_ID,
		PARENT_OBJECT_TYPE,
		PARENT_OBJECT_ID,
		USER_ID,
		NAME,
		EMAIL,
		URL,
		IP,
		BODY,
		STATUS,
		CREATION_DATE,
		MODIFIED_DATE
	) VALUES (?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?)
	]]></sql-query>	
		
	<sql-query name="UPDATE_COMMENT" description="UPDATE_COMMENT"><![CDATA[
	UPDATE MUSI_COMMENT SET
		PARENT_COMMENT_ID = ?,
		NAME = ?,
		EMAIL = ?,
		URL = ?,
		IP = ?,
		BODY = ?,
		STATUS = ?,
		MODIFIED_DATE = ?
	WHERE COMMENT_ID = ?		
	]]></sql-query>	
	
	<sql-query name="DELETE_COMMENT" description="UPDATE_COMMENT"><![CDATA[
	DELETE FROM MUSI_COMMENT 
	WHERE COMMENT_ID = ?		
	]]></sql-query>	
				
	<sql-query name="COUNT_COMMENT_BY_OBJECT_TYPE_AND_OBJECT_ID" description="COUNT_COMMENT_BY_OBJECT_TYPE_AND_OBJECT_ID"><![CDATA[
	SELECT COUNT(COMMENT_ID) FROM MUSI_COMMENT 
	WHERE OBJECT_TYPE = ? AND OBJECT_ID = ?		
	]]></sql-query>			
	
	<sql-query name="SELECT_ROOT_COMMENT" description="SELECT_ROOT_COMMENT"><![CDATA[
	SELECT COMMENT_ID, CREATION_DATE FROM MUSI_COMMENT 
	WHERE 
		OBJECT_TYPE = ? AND 
		OBJECT_ID = ?	AND 
		( PARENT_COMMENT_ID IS NULL OR PARENT_COMMENT_ID = -1 ) 
	ORDER BY CREATION_DATE ASC
	]]></sql-query>			
	
	<sql-query name="SELECT_CHILD_COMMENT" description="SELECT_CHILD_COMMENT"><![CDATA[
	SELECT 
		COMMENT_ID, PARENT_COMMENT_ID 
	FROM MUSI_COMMENT 
	WHERE 
		OBJECT_TYPE = ? 
		AND OBJECT_ID = ?	
		AND PARENT_COMMENT_ID IS NOT NULL 
		AND PARENT_COMMENT_ID > 0
	ORDER BY 
		CREATION_DATE, 
		COMMENT_ID ASC	
	]]></sql-query>	
	
	
	<!-- ==================== -->
	<!-- ATTACHMENT -->
	<!-- ==================== -->	
	<sql-query name="SELECT_ALL_ATTACHMENTS" description="전체 첨부파일 조회"><![CDATA[    
    SELECT 
		ATTACHMENT_ID,
		OBJECT_TYPE,
		OBJECT_ID,
		CONTENT_TYPE,
		FILE_NAME,
		FILE_SIZE,
		USER_ID,
		CREATION_DATE,
		MODIFIED_DATE
    FROM 
    	V2_ATTACHMENT
    ]]></sql-query>
	<sql-query name="SELECT_ATTACHMENT_BY_ID" description="ID로 첨부파일  조회"><![CDATA[    
    SELECT 
		ATTACHMENT_ID,
		OBJECT_TYPE,
		OBJECT_ID,
		CONTENT_TYPE,
		FILE_NAME,
		FILE_SIZE,
		USER_ID,
		CREATION_DATE,
		MODIFIED_DATE
    FROM 
    	V2_ATTACHMENT
    WHERE 
    	ATTACHMENT_ID = ?	    
    ]]></sql-query>
	<sql-query name="SELECT_ATTACHMENT_BY_OBJECT_TYPE_AND_OBJECT_ID"
		description="OBJECT_TYPE 와 OBJECT_ID 값으로 첨부파일  조회"><![CDATA[    
    SELECT 
		ATTACHMENT_ID,
		OBJECT_TYPE,
		OBJECT_ID,
		CONTENT_TYPE,
		FILE_NAME,
		FILE_SIZE,
		USER_ID,
		CREATION_DATE,
		MODIFIED_DATE
    FROM 
    	V2_ATTACHMENT
    WHERE 
    	OBJECT_TYPE = ?	AND
    	OBJECT_ID = ?
    ]]></sql-query>
	<sql-query name="SELECT_ATTACHMENT_DATA_BY_ID" description="ID 값으로 첨부파일 데이터 조회"><![CDATA[    
    SELECT 
		ATTACHMENT_ID,
		ATTACHMENT_DATA
    FROM 
    	V2_ATTACHMENT_DATA
    WHERE 
    	ATTACHMENT_ID = ?
    ]]></sql-query>
	<sql-query name="INSERT_ATTACHMENT" description="첨부파일  생성"><![CDATA[    
    INSERT INTO V2_ATTACHMENT (
		ATTACHMENT_ID,
		OBJECT_TYPE,
		OBJECT_ID,
		CONTENT_TYPE,
		FILE_NAME,
		FILE_SIZE,
		USER_ID,
		CREATION_DATE,
		MODIFIED_DATE
	) VALUES ( 	?,?,?,?,?,?,?,?, ? )
    ]]></sql-query>

	<sql-query name="UPDATE_ATTACHMENT" description="첨부파일  생성"><![CDATA[    
    UPDATE V2_ATTACHMENT SET 		
		OBJECT_TYPE = ?,
		OBJECT_ID = ?,
		CONTENT_TYPE = ?,
		FILE_NAME = ?,
		FILE_SIZE = ?,
		CREATION_DATE = ?,
		MODIFIED_DATE = ?
	WHERE ATTACHMENT_ID = ?
    ]]></sql-query>

	<sql-query name="DELETE_ATTACHMENT" description="첨부파일  삭제"><![CDATA[    
 		DELETE FROM V2_ATTACHMENT WHERE ATTACHMENT_ID = ?
    ]]></sql-query>

	<sql-query name="SELECT_ATTACHMENT_IDS" description="첨부파일 아이디 조회"><![CDATA[    
 		SELECT ATTACHMENT_ID FROM  V2_ATTACHMENT_DATA
    ]]></sql-query>

	<sql-query name="CREATE_EMPTY_ATTACHMENT_DATA" description="첨부파일 데이터 생성"><![CDATA[    
 		INSERT INTO V2_ATTACHMENT_DATA (ATTACHMENT_ID, ATTACHMENT_DATA) VALUES (?, EMPTY_BLOB())
    ]]></sql-query>

	<sql-query name="UPDATE_ATTACHMENT_DATA" description="첨부파일 데이터 업데이트"><![CDATA[    
 		UPDATE V2_ATTACHMENT_DATA  SET ATTACHMENT_DATA = ? WHERE ATTACHMENT_ID = ?
    ]]></sql-query>

	<sql-query name="CREATE_ATTACHMENT_DATA" description="첨부파일 데이터 생성"><![CDATA[    
 		INSERT V2_ATTACHMENT_DATA  (ATTACHMENT_ID, ATTACHMENT_DATA) VALUES (?, ?)
    ]]></sql-query>

	<sql-query name="SELECT_ATTACHMENT_DATA_BY_ID" description="첨부파일 데이터 조회"><![CDATA[    
 		SELECT ATTACHMENT_DATA FROM V2_ATTACHMENT_DATA WHERE ATTACHMENT_ID = ?
    ]]></sql-query>

	<sql-query name="DELETE_ATTACHMENT_DATA_BY_ID" description="첨부파일 데이터 삭제"><![CDATA[    
 		DELETE FROM V2_ATTACHMENT_DATA WHERE ATTACHMENT_ID = ?
    ]]></sql-query>

	<sql-query name="DELETE_ALL_ATTACHMENT_DATAS" description="전체 첨부파일 데이터 삭제"><![CDATA[    
 		DELETE FROM V2_ATTACHMENT_DATA
    ]]></sql-query>

	<sql-query name="COUNT_ATTACHMENT_BY_OBJECT_TYPE_AND_OBJECT_ID"
		description="전체 첨부파일 수 조회"><![CDATA[    
	SELECT COUNT(ATTACHMENT_ID)
	FROM V2_ATTACHMENT        
	WHERE 
    	OBJECT_TYPE = ?	AND OBJECT_ID = ?
    ]]></sql-query>

	<sql-query name="USAGE_ATTACHMENT_BY_OBJECT_TYPE_AND_OBJECT_ID"
		description="OBJECT_TYPE 와 OBJECT_ID 해당 이미지 크기 조회"><![CDATA[    
	SELECT SUM(FILE_SIZE)
	FROM V2_ATTACHMENT
	WHERE 
		OBJECT_TYPE = ?	AND OBJECT_ID = ?
	]]></sql-query>
	
	<!-- ==================== -->
	<!-- IMAGE -->
	<!-- ==================== -->
	<sql-query name="SELECT_IMAGE_LINK_BY_LINK_ID" description="SELECT_IMAGE_LINK_BY_LINK_ID"><![CDATA[    
	SELECT 
		LINK_ID,
		IMAGE_ID,
		PUBLIC_SHARED
	FROM V2_IMAGE_LINK 
	WHERE LINK_ID = ? 
    ]]></sql-query>

	<sql-query name="SELECT_IMAGE_LINK_BY_IMAGE_ID" description="SELECT_IMAGE_LINK_BY_IMAGE_ID"><![CDATA[    
	SELECT 
		LINK_ID,
		IMAGE_ID,
		PUBLIC_SHARED
	FROM V2_IMAGE_LINK 
	WHERE IMAGE_ID = ? 	
    ]]></sql-query>

	<sql-query name="INSERT_IMAGE_LINK" description="INSERT_IMAGE_LINK"><![CDATA[    
	INSERT INTO V2_IMAGE_LINK (
		LINK_ID,
		IMAGE_ID,
		PUBLIC_SHARED
	) VALUES ( ?, ? ,? )	
    ]]></sql-query>

	<sql-query name="DELETE_IMAGE_LINK_BY_LINK_ID" description="DELETE_IMAGE_LINK_BY_LINK_ID"><![CDATA[    
	DELETE FROM V2_IMAGE_LINK WHERE LINK_ID = ?
    ]]></sql-query>

	<sql-query name="DELETE_IMAGE_LINK_BY_IMAGE_ID" description="DELETE_IMAGE_LINK_BY_IMAGE_ID"><![CDATA[    
	DELETE FROM V2_IMAGE_LINK WHERE IMAGE_ID = ?
    ]]></sql-query>

	<sql-query name="CREATE_IMAGE" description="ID로 IMAGE 조회"><![CDATA[    
  		INSERT INTO V2_IMAGE (
	  		IMAGE_ID,
			OBJECT_TYPE,
			OBJECT_ID,
			FILE_NAME,
			FILE_SIZE,
			CONTENT_TYPE,
			USER_ID,
			CREATION_DATE,
			MODIFIED_DATE
		) VALUES ( ?, ? ,?, ?, ?, ?, ?, ? , ?)
    ]]></sql-query>

	<sql-query name="UPDATE_IMAGE" description="ID로 IMAGE 조회"><![CDATA[    
  		UPDATE V2_IMAGE SET
	  		IMAGE_ID = ?,
			OBJECT_TYPE = ?,
			OBJECT_ID = ?,
			FILE_NAME = ?,
			FILE_SIZE = ?,
			CONTENT_TYPE = ?,
			MODIFIED_DATE = ?
		WHERE IMAGE_ID = ?
    ]]></sql-query>

	<sql-query name="SELECT_IMAGE_BY_ID" description="ID로 IMAGE 조회"><![CDATA[    
  		SELECT
	  		IMAGE_ID,
			OBJECT_TYPE,
			OBJECT_ID,
			FILE_NAME,
			FILE_SIZE,
			CONTENT_TYPE,
			USER_ID,
			CREATION_DATE,
			MODIFIED_DATE
		FROM V2_IMAGE WHERE IMAGE_ID = ?
    ]]></sql-query>

	<sql-query name="DELETE_IMAGE_BY_ID" description="IMAGE  삭제"><![CDATA[    
 		DELETE FROM V2_IMAGE WHERE IMAGE_ID = ?
    ]]></sql-query>

	<sql-query name="CREATE_EMPTY_IMAGE_DATA" description="IMAGE 데이터 생성"><![CDATA[    
 		INSERT INTO V2_IMAGE_DATA (IMAGE_ID, IMAGE_DATA) VALUES (?, EMPTY_BLOB())
    ]]></sql-query>

	<sql-query name="UPDATE_IMAGE_DATA" description="IMAGE 데이터 생성"><![CDATA[    
 		UPDATE V2_IMAGE_DATA  SET IMAGE_DATA = ? WHERE IMAGE_ID = ?
    ]]></sql-query>

	<sql-query name="CREATE_IMAGE_DATA" description="IMAGE 데이터 생성"><![CDATA[    
 		INSERT V2_IMAGE_DATA  (IMAGE_ID, IMAGE_DATA) VALUES (?, ?)
    ]]></sql-query>

	<sql-query name="SELECT_IMAGE_DATA_BY_ID" description="IMAGE 데이터 조회"><![CDATA[    
 		SELECT IMAGE_DATA FROM V2_IMAGE_DATA WHERE IMAGE_ID = ?
    ]]></sql-query>

	<sql-query name="DELETE_IMAGE_DATA_BY_ID" description="IMAGE 데이터 삭제"><![CDATA[    
 		DELETE FROM V2_IMAGE_DATA WHERE IMAGE_ID = ?
    ]]></sql-query>

	<sql-query name="SELECT_IMAGE_BY_OBJECT_TYPE_AND_OBJECT_ID"
		description="OBJECT_TYPE 와 OBJECT_ID 값으로 이미지  조회"><![CDATA[    
    SELECT 
	  		IMAGE_ID,
			OBJECT_TYPE,
			OBJECT_ID,
			FILE_NAME,
			FILE_SIZE,
			CONTENT_TYPE,
			USER_ID,
			CREATION_DATE,
			MODIFIED_DATE
    FROM 
    	V2_IMAGE
    WHERE 
    	OBJECT_TYPE = ?	AND OBJECT_ID = ?
    ]]></sql-query>

	<sql-query name="SELECT_IMAGE_IDS_BY_OBJECT_TYPE_AND_OBJECT_ID"
		description="OBJECT_TYPE 와 OBJECT_ID 값으로 이미지  아이디 조회"><![CDATA[    
    SELECT 
	  		IMAGE_ID
    FROM 
    	V2_IMAGE
    WHERE 
    	OBJECT_TYPE = ?	AND OBJECT_ID = ?
    order by MODIFIED_DATE desc	
    ]]></sql-query>

	<sql-query name="COUNT_IMAGE_BY_OBJECT_TYPE_AND_OBJECT_ID"
		description="OBJECT_TYPE 와 OBJECT_ID 해당 이미지 수 조회"><![CDATA[    
	SELECT COUNT(IMAGE_ID)
	FROM V2_IMAGE        
	WHERE 
    	OBJECT_TYPE = ?	AND OBJECT_ID = ?
    ]]></sql-query>

	<sql-query name="USAGE_IMAGE_BY_OBJECT_TYPE_AND_OBJECT_ID"
		description="OBJECT_TYPE 와 OBJECT_ID 해당 이미지 크기 조회"><![CDATA[    
	SELECT SUM(FILE_SIZE)
	FROM V2_IMAGE
	WHERE 
		OBJECT_TYPE = ?	AND OBJECT_ID = ?
	]]></sql-query>
	
	<!-- ==================== -->
	<!-- LOGO -->
	<!-- ==================== -->
	<sql-query name="RESET_LOGO_IMAGE_BY_OBJECT_TYPE_AND_OBJECT_ID"
		description="RESET_LOGO_IMAGE_BY_OBJECT_TYPE_AND_OBJECT_ID"><![CDATA[    	
	UPDATE V2_LOGO 
	SET PRIMARY_IMAGE = 0  
	WHERE OBJECT_TYPE = ? AND OBJECT_ID = ?
	]]></sql-query>
	<sql-query name="CREATE_LOGO_IMAGE" description="CREATE_LOGO_IMAGE"><![CDATA[
		INSERT INTO V2_LOGO (
			LOGO_ID,
			OBJECT_TYPE,
			OBJECT_ID,
			PRIMARY_IMAGE,
			FILE_NAME,
			FILE_SIZE,
			CONTENT_TYPE,
			CREATION_DATE,
			MODIFIED_DATE
		) VALUES (
			?, ?, ?, ?, ?, ?, ?, ?, ?
		)
	]]></sql-query>
	<sql-query name="UPDATE_LOGO_IMAGE" description="UPDATE_LOGO_IMAGE"><![CDATA[
		UPDATE V2_LOGO SET
			OBJECT_TYPE = ?,
			OBJECT_ID = ?,
			PRIMARY_IMAGE = ?,
			FILE_NAME = ?,
			FILE_SIZE = ?,
			CONTENT_TYPE = ?,
			MODIFIED_DATE = ?
		WHERE
			LOGO_ID = ?	
	]]></sql-query>
	<sql-query name="DELETE_LOGO_IMAGE_DATA_BY_ID" description="DELETE_LOGO_IMAGE_DATA_BY_ID"><![CDATA[    	
	DELETE FROM V2_LOGO_DATA
	WHERE
		LOGO_ID = ?	
	]]></sql-query>
	<sql-query name="INSERT_EMPTY_LOGO_IMAGE_DATA" description="INSERT_EMPTY_LOGO_IMAGE_DATA"><![CDATA[    	
	INSERT INTO V2_LOGO_DATA (LOGO_ID, LOGO_DATA) VALUES (?, EMPTY_BLOB())
	]]></sql-query>
	<sql-query name="UPDATE_LOGO_IMAGE_DATA" description="UPDATE_LOGO_IMAGE_DATA"><![CDATA[    	
		UPDATE V2_LOGO_DATA
		SET 
			LOGO_DATA = ?
		WHERE
			LOGO_ID = ?	
	]]></sql-query>
	<sql-query name="INSERT_LOGO_IMAGE_DATA" description="INSERT_LOGO_IMAGE_DATA"><![CDATA[    	
	INSERT INTO V2_LOGO_DATA ( LOGO_ID, LOGO_DATA ) VALUES (?, ?)
	]]></sql-query>
	<sql-query name="DELETE_LOGO_IMAGE_BY_ID" description="DELETE_LOGO_IMAGE_BY_ID"><![CDATA[    	
	DELETE FROM V2_LOGO
	WHERE
		LOGO_ID = ?	
	]]></sql-query>
	<sql-query name="SELECT_LOGO_IMAGE_DATA_BY_ID" description="SELECT_LOGO_IMAGE_DATA_BY_ID"><![CDATA[    	
	SELECT LOGO_DATA FROM V2_LOGO_DATA WHERE LOGO_ID = ?	
	]]></sql-query>
	<sql-query name="SELECT_PRIMARY_LOGO_IMAGE_ID_BY_OBJECT_TYPE_AND_OBJECT_ID"
		description="SELECT_PRIMARY_LOGO_IMAGE_ID_BY_OBJECT_TYPE_AND_OBJECT_ID"><![CDATA[ 
	SELECT LOGO_ID 
	FROM V2_LOGO 
	WHERE OBJECT_TYPE = ? AND OBJECT_ID = ? AND  PRIMARY_IMAGE = 1	
	]]></sql-query>
	<sql-query name="SELECT_LOGO_IMAGE_BY_ID" description="SELECT_LOGO_IMAGE_BY_ID"><![CDATA[    	
	SELECT 
		LOGO_ID,
		OBJECT_TYPE,
		OBJECT_ID,
		PRIMARY_IMAGE,
		FILE_NAME,
		FILE_SIZE,
		CONTENT_TYPE,
		CREATION_DATE,
		MODIFIED_DATE
	FROM V2_LOGO 	
	WHERE LOGO_ID = ?	
	]]></sql-query>
	<sql-query name="SELECT_LOGO_IMAGE_IDS_BY_OBJECT_TYPE_AND_OBJECT_ID"
		description="SELECT_LOGO_IMAGE_IDS_BY_OBJECT_TYPE_AND_OBJECT_ID"><![CDATA[    	
	SELECT 
		LOGO_ID 
	FROM V2_LOGO 
	WHERE OBJECT_TYPE = ? AND OBJECT_ID = ?
	]]></sql-query>
	<sql-query name="COUNT_LOGO_IMAGE_BY_OBJECT_TYPE_AND_OBJECT_ID"
		description="COUNT_LOGO_IMAGE_BY_OBJECT_TYPE_AND_OBJECT_ID"><![CDATA[    	
	SELECT 
		COUNT(LOGO_ID)
	FROM V2_LOGO 
	WHERE OBJECT_TYPE = ? AND OBJECT_ID = ?
	]]></sql-query>
</sqlset>